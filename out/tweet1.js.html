<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: tweet1.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: tweet1.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//@author : vinitshahdeo
const Twitter = require('twitter');
const base64 = require('node-base64-image');
const config = require('./config');
const hashtags = require('../utils/hashtags');
const quote = require('inspirational-quotes');
const today = require('../utils/today');

/**
 * @description Used to create a twitter client
 */
var client = new Twitter({
    consumer_key: config.consumer_key,
    consumer_secret: config.consumer_secret,
    access_token_key: config.access_token_key,
    access_token_secret: config.access_token_secret
});

/**
 * 
 * @param {string} imageURL URL of a random image fetched using Unspalsh API
 * @description encodes the image to base64
 */
function encodeImage(imageURL) {
    
    base64.encode(imageURL, {
        string: true
    }, postImage);
}


// upload image to twitter
/**
 * 
 * @param {object} error represents the error while posting the image to the twitter
 * @param {object} image represents the encoded image
 * @description this function posts the image to the twitter.
 */
function postImage(error, image) {
    if (error) {
        console.log(error);
    }

    client.post('media/upload', {
        media_data: image
    }, getTweet);
}


// select random quote
/**
 * 
 * @param {object} error error occured if any
 * @param {object} media contains the media file i.e image to be tweeted
 * @param {object} result final outcome
 * @description this function fetches the random quotes along with greetings and hashtags to tweet
 */
function getTweet(error, media, result) {
    var quoteToTweet = quote.getRandomQuote();
    var hashtag = hashtags[Math.floor(Math.random() * hashtags.length)];
    var greetings = '\nHappy ' + today.getDay() + '!\n';
     
    if (!error) {
        // Lets tweet it
        var messageToTweet = quoteToTweet +' '+ greetings +'#' +hashtag;
        console.log(messageToTweet);
        var status = {
            status: messageToTweet,
            media_ids: media.media_id_string // Pass the media id string
        }
        // post the tweet
        tweetNow(status);
        
    }
}

/**
 * 
 * @param {object} status tweet to be posted
 * @description it posts the tweet to the timeline
 */
function tweetNow(status){
    client.post('statuses/update', status, function(error, result) {
        if (error) {
            console.log(error)
        }
    });
}

/**
 * @description API to fetch random images
 */
var imageURL = 'https://source.unsplash.com/featured/?motivation';

// encode the image to base64
encodeImage(imageURL);</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#client">client</a></li><li><a href="global.html#encodeImage">encodeImage</a></li><li><a href="global.html#getTweet">getTweet</a></li><li><a href="global.html#imageURL">imageURL</a></li><li><a href="global.html#postImage">postImage</a></li><li><a href="global.html#tweetNow">tweetNow</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Feb 06 2019 21:53:19 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
